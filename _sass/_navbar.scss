@use "variables" as *;
@use "mixins" as *;
@use "flex" as *;
@use "typography" as *;

// responsive-nav.js styles.
.nav-collapse {

  ul {
    display: block;
    list-style: none;
    margin: 0;
    padding: 0;
    width: 100%;
  }

  li {
    display: block;
    width: 100%;
  }

  &.opened {
    max-height: 9999px;
  }
}

.js {

  .nav-collapse {
    clip: rect(0 0 0 0);
    display: block;
    max-height: 0;
    overflow: hidden;
    position: absolute;
    zoom: 1;

    @include breakpoint(break-1) {
      max-height: none;
      position: relative;
    }
  }
}

.disable-pointer-events {
  pointer-events: none;
}

.nav-toggle {
  -webkit-tap-highlight-color: rgba(0,0,0,0);
  -webkit-touch-callout: none;
  user-select: none;

  @include breakpoint(break-1) {
    display: none;
  }
}

.global-header {
  background-color: $bannerColour;
  z-index: 1000;
  display: inline-block;
  @include flexbox;
  @include justify-content(space-between);
  @include align-items(center);
  
  .logo-name {
    text-decoration: none;
    display: flex;
    align-items: center;

    &:hover {
      opacity: 0.85;
      transition: opacity 0.2s;
    }
  }

  .logo {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    margin-right: map-get($gutterwidths, small);
  }

  .profile-text {
    @include fontsize(eta, all);
    color: $bodyColour;
    line-height: 1.2;

    strong {
      color: $headingColour;
    }
  }

  .username {
    @include fontsize(eta, all);
    color: $headingColour;
    font-style: italic;
    line-height: 1.2;
  }
}

// Top-level navigation container
.main-nav {
  position: sticky;
  top: 0;
  z-index: 1000;
  display: inline-block;
  @include flexbox;
  @include justify-content(space-between);
  @include align-items(center);
  background-color: $bannerColour;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);

  &.scrolled {
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
    transition: box-shadow 0.2s ease;
  }
  
.js {
  .nav-toggle {
    -webkit-tap-highlight-color: rgba(0,0,0,0);
    -webkit-touch-callout: none;
    user-select: none;
    background: none;
    border: none;
    cursor: pointer;
    padding: map-get($gutterwidths, small);
    margin-left: map-get($gutterwidths, small);
    display: block;
    line-height: 0;
    position: absolute;
    right: map-get($gutterwidths, large);
    top: 50%;
    transform: translateY(-50%);

    &:after {
      background-image: url(/assets/img/menu.svg);
      background-position: 0 0;
      background-size: 30px 60px;
      content: '';
      display: block;
      height: 30px;
      width: 30px;
    }

    &.active:after {
      background-position: 0 30px;
    }

    @include breakpoint(break-1) {
      display: none;
    }
  }

  .nav-collapse {
    display: none;
    flex-direction: column;
    gap: map-get($gutterwidths, small);
    padding-left: 0;
    width: 100%;
    position: absolute;
    top: 100%;
    left: 0;
    background-color: $bannerColour;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);

    &.opened {
      display: flex;
    }

    @include breakpoint(break-1) {
      display: flex;
      flex-direction: row;
      gap: map-get($gutterwidths, medium);
      padding-left: 0;
      width: auto;
      position: static;
      top: auto;
      left: auto;
      background-color: transparent;
      box-shadow: none;
    }

    ul {
      list-style: none;
      margin: 0;
      padding: 0;
      width: 100%;

      @include breakpoint(break-1) {
        width: auto;
        text-align: right;
      }
    }

    li { // Individual navigation list items
      font-family: unquote(map-get($headingtype, font-family));
      font-style: normal;
      font-weight: map-get($headingtype, regular);

      // Default styles for list items (mainly for mobile)
      display: block; // Stacked on mobile
      width: 100%; // Full width on mobile

      a, span {
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        color: $linkColour;
        cursor: pointer;

        // Base underline properties (visibility controlled by breakpoints)
        position: relative;
        &::after {
          content: '';
          position: absolute;
          width: 0%;
          height: 3px;
          left: 0;
          bottom: -2px;
          background-color: $headingColour;
          transition: width 0.3s ease;
        }
      }

      // Mobile-specific styles (below break-1)
      @media (max-width: #{map-get($breakpoints, break-1) / 16 * 1em - 0.001em}) {
        @include fontsize(16, 0); // Mobile font size
        
        a, span {
          display: block; // Block display for mobile links
          padding: 10px 3%; // Padding for mobile links
          border-bottom: 0.1rem solid darken($white, 15%); // Mobile bottom border
          
          &:hover, &:active, &:focus {
            background-color: $linkColour; // Mobile hover background
            color: $white;
          }
          &::after {
            display: none; // Hide underline on mobile
          }
        }
      }

      @include breakpoint(break-1) { // Desktop styles
        @include fontsize(12, 1); // Desktop font size

        display: inline-block; // Horizontal on desktop
        letter-spacing: 0.1rem;
        margin-right: 2rem;
        padding: 1rem 0; // Desktop padding
        text-transform: uppercase;
        width: auto;

        a, span {
          border: 0; // Remove mobile border on desktop
          color: $captionColour; // Desktop link color
          display: inline; // Inline display for desktop links
          padding: 0; // Remove padding

          &:hover, &:active, &:focus {
            background-color: transparent; // No background on desktop hover
            color: $linkColour;
          }
          &::after {
            display: block; // Show underline on desktop
          }
          // Underline animation on hover/active (applies when display:block)
          &:hover::after,
          &.active::after {
            width: 100%;
          }
        }
      }
      @include breakpoint(break-2) { @include fontsize(12, 2); }
      @include breakpoint(break-3) { @include fontsize(12, 3); }
      @include breakpoint(break-4) { @include fontsize(12, 4); }
    }
  }
}
}
